import React from "react";

import { Link } from 'react-router-dom';

import { useState } from 'react';

import './Header.css';

import cart from '../../icons/cart.png';
import arrow from '../../icons/arrow-down.png'
import logo from '../../icons/няма-няма.png';

import MobileMenu from '../header-menu/header-menu';

const Header = () => {
    

    const [menuActive, setMenuActive] = useState(false);

    const setMenu = () => {
        setMenuActive(!menuActive);
        console.log(menuActive);
    }

    const logoClick = () => {
        if (menuActive) {
            setMenuActive(!menuActive);
        }
        window.scrollTo(0,0);
    }

    const items = [{value:"ГЛАВНАЯ",href:"/"},{value:"КАТАЛОГ",href:"/catalog"},{value:"ДОСТАВКА",href:"/delivery"},{value:"КОНТАКТЫ",href:"/contacts"},{value:"КОРЗИНА",href:"/cart"}];

    const [userCity, setUserCity] = useState("Москва");
    const [isCitiesVisible, setIsCitiesVisible] = useState(false);

    const handleCityClick = (city) => {
        setUserCity(city);
        setIsCitiesVisible(false);
    };

    if (isCitiesVisible) {
        const CitiesList = document.getElementById("citieslist");
        CitiesList.classList.remove("cities__animation-hide");
        CitiesList.classList.add("cities__animation");
        CitiesList.style.display = "flex";
    }
    else {
        setTimeout(() => {
            const CitiesList = document.getElementById("citieslist");
            CitiesList.classList.replace("cities__animation", "cities__animation-hide");
            CitiesList.style.display = "none";
        }, "000");
        
    };

    const copyNumber = () => {

        var textarea = document.createElement('textarea');
            textarea.value = '89999292879';
            document.body.appendChild(textarea);


            textarea.select();

  
            document.execCommand('copy');


            document.body.removeChild(textarea);

        const copiedText = document.getElementById("copied");
        copiedText.style.opacity = 1;

        setTimeout(() => {
            copiedText.style.opacity = 0;
        }, "3000")
    };

    return (
        <>
        <header className="header">
            <div className="header__mobile">
                <Link onClick={logoClick} to="/" className="header__mobile-logo">
                    <img src={logo} className="mobile-logo" alt="Логотип"/>
                    <p>Суши-центр</p>
                </Link>
                <ul className="header__burger" onClick={setMenu}>
                    <li className="burger-line"></li>
                    <li className="burger-line"></li>
                    <li className="burger-line"></li>
                </ul>
                
            </div>
            <div className="header__container">
                <ul className="header__menu">
                    <li className="header__menu-item">
                        <Link onClick={() => window.scrollTo(0, 0)} to="/">
                            <img className="header__logo" src={logo} alt="Логотип" />
                        </Link>
                    </li>
                    <li className="header__menu-item">
                        <Link onClick={() => window.scrollTo(0, 0)}  to="/" className="header__menu-link current-page">ГЛАВНАЯ</Link>
                        <div className="menu-underline"></div>
                    </li>
                    <li className="header__menu-item">
                        <Link onClick={() => window.scrollTo(0, 0)} to="/catalog" className="header__menu-link">КАТАЛОГ</Link>
                        <div className="menu-underline"></div>
                    </li>
                    <li className="header__menu-item">
                        <Link onClick={() => window.scrollTo(0, 0)} className="header__menu-link" to="/delivery">ДОСТАВКА</Link>
                        <div className="menu-underline"></div>
                    </li>
                    <li className="header__menu-item">
                        <Link onClick={() => window.scrollTo(0, 0)} to="/contacts" className="header__menu-link" >КОНТАКТЫ</Link>
                        <div className="menu-underline"></div>
                    </li>
                </ul>
                <ul className="header__menu__more">
                    <li className="menu__more-item">
                        <Link to="/cart" onClick={() => window.scrollTo(0, 0)} className="menu__more-link with-cart">
                            <p>Корзина</p>
                            <img className="header__icon cart-img" alt="Корзина" src={cart}/>
                        </Link>
                    </li>
                    <li className="menu__more-item with-arrow">
                        <a className="menu__more-link" onMouseEnter={() => setIsCitiesVisible(true)} onMouseLeave={() => setIsCitiesVisible(false)}>
                            <p>{userCity}</p>
                            <img className="header__icon arrow" alt="Стрелка" src={arrow}/>
                            <ul id="citieslist" className="header__cities">
                                <li className="header__city">
                                    <p className="city__name" onClick={() => handleCityClick("Москва")}>Москва</p>
                                </li>
                                <li className="header__city">
                                    <p className="city__name" onClick={() => handleCityClick("Санкт-Петербург")}>Санкт-Петербург</p>
                                </li>
                                <li className="header__city">
                                    <p className="city__name"  onClick={() => handleCityClick("Ростов на Дону")}>Ростов на Дону</p>
                                </li>
                                <li className="header__city">
                                    <p className="city__name"  onClick={() => handleCityClick("Хабаровск")}>Хабаровск</p>
                                </li>
                            </ul>
                        </a>
                    </li>
                </ul>
                <div  className="header__number " >
                    <p id="copied" className="header__number-text copied">Номер телефона скопирован</p>
                    <p onClick={copyNumber} className="header__number-number">+7 (999) 929 28-79</p>
                    <p className="header__number-text">Телефон горячей линии</p>
                </div>
            </div>
            <MobileMenu active={menuActive} setActive={setMenuActive} header={"Меню"} items={items}/>
        </header>
        </>
    );
}

export default Header;